# Описание

Используется django + drf. 

Аутентификация bearer token из drf. Это позволяет рботать не только с пользователями из браузера, но и из других клиенских приложений.

База данных postrges, в sqlite не работает регистронезависимый поиск по кириллице.

Инфрмация о карте (местоположение объекта) отправляется в виде iframe. 

При разработке использовался Python 3.10

## Запуск проекта

### Устновка модулей

```
pip install -r req.txt
```

### Настройка базы и режима работы. 

В settings.py есть класс, в атрибуты которого устанавливаются из переменных окружения или берутся дефолтные значения

```Python
@dataclass
class Env:
    DEBUG: bool = os.environ.get('DJANGO_DEBUG') == 'true' or True # загшука
    SECRET_KEY: str = os.environ.get('DJANGO_SECRET', '1234')
    DB_USER: str = os.environ.get('DB_USER', 'localbase')
    DB_NAME: str = os.environ.get('DB_NAME', 'localbase')
    DB_PASS: str = os.environ.get('DB_PASS', 'localpass')
    DB_ADDR: str = os.environ.get('DB_ADDR', 'localhost')
    DB_PORT: int = int(os.environ.get('DB_PORT', '5432'))
```

По имени полей можно определить параметр django. Доступные имена переменных окружения также все перечислены.

### Запуск

Боевой экземляр лучше запускать с помощью uwsgi или gunicorn. Для демонстрации проект запущен с помощью python в Debug режиме.

Запуск сервера

```shell
python manage.py runserver IP:PORT
```

## Доступные методы

### Регистрация

POST /user/register

Тип данных form-data. Возвращает информацию о пользователе и токен для аворизации.

### Вход

POST /user/login

Тип данных json. Возвращает информацию о пользователе и токен для аворизации.

### Информация о пользователе

GET /user/info

Параметры необязательны. По умолчанию возвращает информацию по токену. Если передан параметр user_id, то возвращает инфу по id пользователя. Требуется авторизация.

Возвращает подробную информацию о пользователе: информацию о его фаворитах и галерее.

### Список разделов книги

GET /species/types

Не принимает параметры. Авторизация не требуется.

### Список животных и растений

GET /species/list

Принимает необязательные параметры: раздел (type), фреал обитания (habitat_area_id) и строку поиска по имени или названию места обитания (search). Авторизованному пользователю помечает его фаворитов, они также помещаются в начало списка.

### Добавить фаворита

POST /change_favorite

Тип данных json. Требуется авторизация

### Удалить фаворита

DELETE /change_favorite

Тип данных json. Требуется авторизация

### Информация о животном или растении

GET /species/detail

Обязательный параметр id

Полная информацию о животном или растении в системе. А также список ареалов его обитания и галлерею фотографий с ним (не пользовательских).

### Список топ фаворитов

GET /species/top_favorite

Не примает параметры. Возвращает самых "залайканых" животных.

### Список ареалов обитания 

GET /arias/list

Не принимает параметры. Возвращает краткую информацию о каждом ареале

### Информация об ареале обитания

GET /arias/detail

Принимает параметр area_id. Возвращает подробную информацию об ареале обитания.